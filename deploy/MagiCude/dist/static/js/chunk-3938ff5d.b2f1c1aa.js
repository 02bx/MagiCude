(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-3938ff5d"],{"1d97":function(e,t,n){"use strict";n("99af");var o=n("b775"),a="center",i="assetport";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"get"})},search:function(e,t,n){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:n})},save:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"delete"})},findByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/ids"),method:"post",data:e})},findAllDistinctService:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/service"),method:"get"})},findAllDistinctVersion:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/version"),method:"get"})},findAllByAssetipId:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/assetip/").concat(e),method:"get"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"35e8":function(e,t,n){"use strict";n("99af");var o=n("b775"),a="center",i="vulnpluginconfig";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"get"})},search:function(e,t,n){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:n})},save:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"get"})},findByPluginId:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/plugin/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"delete"})},deleteByPluginId:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/plugin/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"36d7":function(e,t,n){"use strict";n("99af");var o=n("b775"),a="center",i="vulnkeyword";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"get"})},search:function(e,t,n){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:n})},save:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"get"})},findByPluginId:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/plugin/").concat(e),method:"get"})},findAllDistinctVulnKeyword:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/plugin"),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"406e":function(e,t,n){"use strict";n("99af");var o=n("b775"),a="center",i="pluginassetversion";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"get"})},search:function(e,t,n){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:n})},save:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"get"})},findByPluginId:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/plugin/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"52ce":function(e,t,n){"use strict";n.r(t);var o=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{padding:"5px"}},[n("br"),n("el-form",{ref:"searchform",attrs:{inline:"",size:"small",model:e.searchMap}},[n("el-form-item",{attrs:{prop:"name",label:"名称"}},[n("el-select",{attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getNameList,loading:e.searchLoading},model:{value:e.searchMap.name,callback:function(t){e.$set(e.searchMap,"name",t)},expression:"searchMap.name"}},e._l(e.nameList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),n("el-form-item",{attrs:{prop:"args",label:"参数"}},[n("el-select",{attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getArgsList,loading:e.searchLoading},model:{value:e.searchMap.args,callback:function(t){e.$set(e.searchMap,"args",t)},expression:"searchMap.args"}},e._l(e.argsList,(function(e){return n("el-option",{key:e.id,attrs:{label:e.args,value:e.args}})})),1)],1),n("el-form-item",{attrs:{label:"风险"}},[n("el-radio-group",{attrs:{size:"mini"},model:{value:e.searchMap.risk,callback:function(t){e.$set(e.searchMap,"risk",t)},expression:"searchMap.risk"}},[n("el-radio-button",{attrs:{label:"信息"}}),n("el-radio-button",{attrs:{label:"低危"}}),n("el-radio-button",{attrs:{label:"中危"}}),n("el-radio-button",{attrs:{label:"高危"}}),n("el-radio-button",{attrs:{label:"严重"}}),n("el-radio-button",{attrs:{label:"致命"}})],1)],1),n("el-form-item",{attrs:{label:"类型"}},[n("el-radio-group",{attrs:{size:"mini"},model:{value:e.searchMap.type,callback:function(t){e.$set(e.searchMap,"type",t)},expression:"searchMap.type"}},[n("el-radio-button",{attrs:{label:"selfd"}}),n("el-radio-button",{attrs:{label:"nse"}})],1)],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fetchData()}}},[e._v("查询")]),n("el-button",{attrs:{type:"info"},on:{click:function(t){return e.resetForm("searchform")}}},[e._v("重置")])],1),n("el-form-item",[n("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"默认名字：报告",clearable:"","prefix-icon":"el-icon-document"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),n("el-button",{attrs:{loading:e.downloadLoading,type:"success",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v("导出")])],1),n("el-form-item",[n("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDeleteAll}},[e._v("删除")])],1),n("el-form-item",[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit("")}}},[e._v("新增")])],1)],1),n("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"selection-change":e.handleSelectionChange}},[n("el-table-column",{attrs:{type:"selection",align:"center"}}),n("el-table-column",{attrs:{label:"序号",type:"index",index:1,align:"center",width:"50"}}),n("el-table-column",{attrs:{sortable:"",prop:"name",label:"名称"}}),n("el-table-column",{attrs:{sortable:"",prop:"args",label:"参数","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{sortable:"",prop:"risk",label:"风险"}}),n("el-table-column",{attrs:{sortable:"",prop:"type",label:"类型"}}),n("el-table-column",{attrs:{sortable:"",prop:"validatetype",label:"辅助验证"}}),n("el-table-column",{attrs:{sortable:"",prop:"timeout",label:"超时"}}),n("el-table-column",{attrs:{sortable:"",prop:"plugincode",label:"插件代码","show-overflow-tooltip":""}}),n("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(n){return e.handleEdit(t.row.id)}}}),n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.handleDelete(t.row.id)}}})]}}])})],1),n("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,200,500,1e3],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.handleSizeChange,"current-change":e.fetchData}}),n("el-dialog",{attrs:{title:"编辑",visible:e.dialogFormVisible,width:"50%",center:"","before-close":e.cleanCache},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[n("el-form",{attrs:{"label-width":"100px"}},[n("el-form-item",{attrs:{label:"名称",required:""}},[n("el-input",{staticStyle:{width:"400px"},model:{value:e.pojo.name,callback:function(t){e.$set(e.pojo,"name",t)},expression:"pojo.name"}})],1),n("el-form-item",{attrs:{label:"参数"}},[n("el-input",{attrs:{autosize:"",type:"textarea"},model:{value:e.pojo.args,callback:function(t){e.$set(e.pojo,"args",t)},expression:"pojo.args"}})],1),n("el-form-item",{attrs:{label:"风险"}},[n("el-radio-group",{attrs:{size:"mini"},model:{value:e.pojo.risk,callback:function(t){e.$set(e.pojo,"risk",t)},expression:"pojo.risk"}},[n("el-radio-button",{attrs:{label:"信息"}}),n("el-radio-button",{attrs:{label:"低危"}}),n("el-radio-button",{attrs:{label:"中危"}}),n("el-radio-button",{attrs:{label:"高危"}}),n("el-radio-button",{attrs:{label:"严重"}}),n("el-radio-button",{attrs:{label:"致命"}})],1)],1),n("el-form-item",{attrs:{label:"类型"}},[n("el-radio-group",{attrs:{size:"mini"},model:{value:e.pojo.type,callback:function(t){e.$set(e.pojo,"type",t)},expression:"pojo.type"}},[n("el-radio-button",{attrs:{label:"nse"}}),n("el-tooltip",{attrs:{placement:"top"}},[n("div",{attrs:{slot:"content"},slot:"content"},[e._v("前端只能新增Python3"),n("br"),e._v("或HTTP/HTTPS访问的自定义插件")]),n("el-radio-button",{attrs:{label:"selfd"}})],1)],1)],1),n("el-form-item",{attrs:{label:"辅助验证",inline:""}},[n("el-checkbox-group",{attrs:{size:"mini"},model:{value:e.checkedChecktypes,callback:function(t){e.checkedChecktypes=t},expression:"checkedChecktypes"}},e._l(e.checks,(function(e){return n("el-checkbox-button",{key:e,attrs:{label:e}})})),1)],1),n("el-form-item",{attrs:{label:"超时"}},[n("el-input",{staticStyle:{width:"400px"},model:{value:e.pojo.timeout,callback:function(t){e.$set(e.pojo,"timeout",t)},expression:"pojo.timeout"}})],1),n("el-form-item",{attrs:{label:"服务"}},[n("el-form-item",[n("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"","allow-create":"","default-first-option":"",placeholder:"请输入关键词搜索","remote-method":e.remoteSearchService,loading:e.searchLoading},model:{value:e.selectedServiceList,callback:function(t){e.selectedServiceList=t},expression:"selectedServiceList"}},e._l(e.remoteServiceOptions,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),e.pojo.id?n("span",[n("el-form-item",[n("el-table",{ref:"multipleTable",attrs:{data:e.servicePojoList,"show-header":!1}},[n("el-table-column",{attrs:{width:"400",prop:"assetservice",label:"服务"}}),n("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.handleDeleteService(t.row.id)}}})]}}],null,!1,4067733770)})],1)],1)],1):e._e(),n("el-form-item",{attrs:{label:"版本"}},[n("el-form-item",[n("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"","allow-create":"","default-first-option":"",placeholder:"请输入关键词搜索","remote-method":e.remoteSearchVersion,loading:e.searchLoading},model:{value:e.selectedVersionList,callback:function(t){e.selectedVersionList=t},expression:"selectedVersionList"}},e._l(e.remoteVersionOptions,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),e.pojo.id?n("span",[n("el-form-item",[n("el-table",{ref:"multipleTable",attrs:{data:e.versionPojoList,"show-header":!1}},[n("el-table-column",{attrs:{width:"400",prop:"assetversion",label:"版本"}}),n("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.handleDeleteVersion(t.row.id)}}})]}}],null,!1,877753133)})],1)],1)],1):e._e(),n("el-form-item",{attrs:{label:"关键字"}},[n("el-form-item",[n("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"","allow-create":"","default-first-option":"",placeholder:"请输入关键词搜索","remote-method":e.remoteSearchVulnkeyword,loading:e.searchLoading},model:{value:e.selectedVulnkeywordList,callback:function(t){e.selectedVulnkeywordList=t},expression:"selectedVulnkeywordList"}},e._l(e.remoteVulnkeywordOptions,(function(e){return n("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1)],1),e.pojo.id?n("span",[n("el-form-item",[n("el-table",{ref:"multipleTable",attrs:{data:e.vulnkeywordPojoList,"show-header":!1}},[n("el-table-column",{attrs:{width:"400",prop:"keyword",label:"关键字"}}),n("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.handleDeleteVulnkeyword(t.row.id)}}})]}}],null,!1,3269353199)})],1)],1)],1):e._e(),n("el-form-item",{attrs:{label:"漏洞"}},[n("el-form-item",[n("el-select",{staticStyle:{width:"400px"},attrs:{multiple:"",filterable:"",remote:"","reserve-keyword":"","default-first-option":"",placeholder:"请输入关键词搜索","remote-method":e.remoteSearchVuln,loading:e.searchLoading},model:{value:e.selectedVulnList,callback:function(t){e.selectedVulnList=t},expression:"selectedVulnList"}},e._l(e.remoteVulnOptions,(function(e){return n("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1)],1),e.pojo.id?n("span",[n("el-form-item",[n("el-table",{ref:"multipleTable",attrs:{data:e.vulnPluginPojoList,"show-header":!1}},[n("el-table-column",{attrs:{width:"400",prop:"name",label:"漏洞"}}),n("el-table-column",{attrs:{width:"50"},scopedSlots:e._u([{key:"default",fn:function(t){return[n("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(n){return e.handleDeleteVulnPlugin(t.row.id)}}})]}}],null,!1,1680420575)})],1)],1)],1):e._e(),n("el-form-item",{attrs:{label:"插件代码"}},[n("div",{staticClass:"in-coder-panel"},[n("textarea",{directives:[{name:"model",rawName:"v-model",value:e.nodearea,expression:"nodearea"}],ref:"textarea",domProps:{value:e.nodearea},on:{input:function(t){t.target.composing||(e.nodearea=t.target.value)}}}),e._v(" "),n("el-select",{staticClass:"code-mode-select",on:{change:e.changeMode},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},e._l(e.modes,(function(e){return n("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)])],1),n("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[n("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSave()}}},[e._v("保存")]),n("el-button",{on:{click:function(t){return e.closeDialogForm()}}},[e._v("关闭")])],1)],1)],1)},a=[],i=(n("4de4"),n("7db0"),n("c975"),n("a15b"),n("d81d"),n("b0c0"),n("d3b7"),n("ac1f"),n("841c"),n("1276"),n("5ad6")),c=n("87b3"),l=n("1d97"),r=n("406e"),s=n("36d7"),u=n("35e8"),d=n("dce3"),h=n("56b3"),f=n.n(h),m=(n("a7be"),n("b866"),n("db91"),n("697eb"),n("aedd"),n("164b"),n("4895"),n("cbc8"),n("8d70"),n("9f09"),n("a2c1"),n("9c7b"),n("715d"),n("23de"),window.CodeMirror||f.a),p=["http","dns"],g={data:function(){return{list:[],total:0,currentPage:1,pageSize:10,searchMap:{},dialogFormVisible:!1,dialogFormVisibleService:!1,pojo:{},id:"",filename:"",listLoading:!0,multipleSelection:[],downloadLoading:!1,nameList:[],argsList:[],searchLoading:!1,checkedChecktypes:[],checks:p,servicePojo:{},servicePojoList:[],serviceList:[],selectedServiceList:[],remoteServiceOptions:[],remoteServiceList:[],versionPojo:{},versionPojoList:[],versionList:[],selectedVersionList:[],remoteVersionOptions:[],remoteVersionList:[],vulnkeywordPojo:{},vulnkeywordPojoList:[],vulnkeywordList:[],selectedVulnkeywordList:[],remoteVulnkeywordOptions:[],remoteVulnkeywordList:[],vulnList:[],selectedVulnList:[],remoteVulnOptions:[],vulnPluginPojo:{},vulnPluginPojoList:[],vulnName:"",plugindemocdoe:"# -*- coding:utf-8 -*-\n# plugin code demo\n# @auther 贰拾壹\n# https://github.com/er10yi\n\ndef check(ip, port, args, timeout, payload_map):\n    # 插件名字包含WeakPass，payload_map才会有用户名密码\n    username_list = payload_map.get('username')\n    password_list = payload_map.get('password')\n\n    # 辅助验证为http，页面返回的data会作为关键词\n    http_validate_list = payload_map.get('http_validate')\n    http_validate = http_validate_list[0]\n    # curl http_validate\n\n    # 辅助验证为dns，dns解析的域名，需要自己手动添加到关键词，否则检测不到\n    dns_validate_list = payload_map.get('dns_validate')\n    dns_validate = dns_validate_list[0]\n    # nslookup args dns_validate\n\n    check_result = \"执行的结果\"\n\n    try:\n        # 只有return的结果，才会带回去，print是没用的\n        return check_result + ' ' + http_validate + ' ' + dns_validate\n    except Exception:\n        raise\n",codeTemp:"",nodearea:"",code:"",mode:"Python",coder:null,options:{tabSize:4,theme:"idea",lineNumbers:!0,styleActiveLine:!0,line:!0,extraKeys:{Ctrl:"autocomplete",Tab:function(e){e.somethingSelected()?e.indentSelection("add"):e.replaceSelection(Array(e.getOption("indentUnit")+1).join(" "),"end","+input")}},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],highlightSelectionMatches:{showToken:/\w/,annotateScrollbar:!0},mode:{name:"python",json:!0}},modes:[{value:"x-python",label:"Python"}]}},created:function(){this.fetchData(),this.getRemoteServiceList(),this.getRemoteVersionList(),this.getRemoteVulnkeywordList()},methods:{codeMirrorInitialize:function(e){var t=this;if(this.$refs.textarea&&(this.coder=m.fromTextArea(this.$refs.textarea,this.options),null!==e?this.coder.setValue(e):this.coder.setValue(""),this.coder.on("change",(function(e){t.code=e.getValue(),t.pojo.plugincode=t.code,t.$emit&&t.$emit("input",t.code)})),this.language)){var n=this._getLanguage(this.language);n&&(this.mode=n.label)}},_getLanguage:function(e){return this.modes.find((function(t){var n=e.toLowerCase(),o=t.label.toLowerCase(),a=t.value.toLowerCase();return o===n||a===n}))},changeMode:function(e){this.coder.setOption("mode","text/".concat(e));var t=this._getLanguage(e).label.toLowerCase();this.$emit("language-change",t)},cleanCache:function(){this.closeDialogForm()},remoteSearchVuln:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,d["a"].search(1,10,{name:e}).then((function(n){t.remoteVulnOptions=n.data.rows.filter((function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.remoteVulnOptions=[]},getRemoteServiceList:function(){var e=this;l["a"].findAllDistinctService().then((function(t){e.remoteServiceList=t.data}))},getRemoteVersionList:function(){var e=this;l["a"].findAllDistinctVersion().then((function(t){e.remoteVersionList=t.data}))},getRemoteVulnkeywordList:function(){var e=this;s["a"].findAllDistinctVulnKeyword().then((function(t){e.remoteVulnkeywordList=t.data}))},remoteSearchService:function(e){var t=this;""!==e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,t.remoteServiceOptions=t.remoteServiceList.filter((function(t){return t.toLowerCase().indexOf(e.toLowerCase())>-1}))}),200)):this.remoteServiceOptions=[]},remoteSearchVersion:function(e){var t=this;""!==e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,t.remoteVersionOptions=t.remoteVersionList.filter((function(t){return t.toLowerCase().indexOf(e.toLowerCase())>-1}))}),200)):this.remoteVersionOptions=[]},remoteSearchVulnkeyword:function(e){var t=this;""!==e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,t.remoteVulnkeywordOptions=t.remoteVulnkeywordList.filter((function(t){return t.toLowerCase().indexOf(e.toLowerCase())>-1}))}),200)):this.remoteVulnkeywordOptions=[]},handleSaveService:function(e,t){this.servicePojo.pluginconfigid=e,this.servicePojo.assetservice=t,c["a"].save(this.servicePojo),this.servicePojo={}},handleDeleteService:function(e){var t=this;this.$confirm("此操作将永久删除已选记录, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){c["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(t.closeDialogForm(),t.handleEdit(t.id))}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleSaveVersion:function(e,t){this.versionPojo.pluginconfigid=e,this.versionPojo.assetversion=t,r["a"].save(this.versionPojo),this.versionPojo={}},handleDeleteVersion:function(e){var t=this;this.$confirm("此操作将永久删除已选记录, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){r["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(t.closeDialogForm(),t.handleEdit(t.id))}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleSaveVulnkeyword:function(e,t){this.vulnkeywordPojo.pluginconfigid=e,this.vulnkeywordPojo.keyword=t,s["a"].save(this.vulnkeywordPojo),this.vulnkeywordPojo={}},handleDeleteVulnkeyword:function(e){var t=this;this.$confirm("此操作将永久删除已选记录, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){s["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(t.closeDialogForm(),t.handleEdit(t.id))}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},handleSaveVulnPlugin:function(e,t){this.vulnPluginPojo.pluginconfigid=e,this.vulnPluginPojo.vulnid=t,u["a"].save(this.vulnPluginPojo),this.vulnPluginPojo={}},handleDeleteVulnPlugin:function(e){var t=this;this.$confirm("此操作将永久删除已选记录, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){u["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(t.closeDialogForm(),t.handleEdit(t.id))}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},getArgsList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{args:e}).then((function(n){t.argsList=n.data.rows.filter((function(t){return t.args.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.argsList=[]},getNameList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{name:e}).then((function(n){t.nameList=n.data.rows.filter((function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.nameList=[]},closeDialogForm:function(){this.dialogFormVisible=!1,this.selectedServiceList=[],this.remoteServiceOptions=[],this.selectedVersionList=[],this.remoteServiceOptions=[],this.selectedVulnkeywordList=[],this.remoteVulnkeywordOptions=[],this.selectedVulnList=[],this.remoteVulnOptions=[],this.checkedChecktypes=[],this.code="",this.coder&&this.$refs.textarea&&this.coder.toTextArea()},closeOpenDialogForm:function(){this.closeDialogForm(),this.dialogFormVisible=!0},handleDeleteAll:function(){var e=this;this.multipleSelection&&this.multipleSelection.length?this.$confirm("此操作将永久删除已选记录信息, 包括 [插件配置, 资产服务, 资产版本, 漏洞关键词, 漏洞插件配置关联, 任务插件配置], 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){for(var t=[],n=0;n<e.multipleSelection.length;n++)t.push(e.multipleSelection[n].id);i["a"].deleteAllByIds(t).then((function(t){e.$message({message:t.message,type:t.flag?"success":"error"}),t.flag&&e.fetchData()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},handleSelectionChange:function(e){this.multipleSelection=e},handleDownload:function(){var e=this;this.multipleSelection&&this.multipleSelection.length?(this.downloadLoading=!0,Promise.all([n.e("chunk-4e233b59"),n.e("chunk-ee77943a")]).then(n.bind(null,"4bf8")).then((function(t){var n=["名称","参数","风险","类型","辅助验证","超时","插件代码"],o=["name","args","risk","type","validatetype","timeout","plugincode"],a=e.multipleSelection,i=e.formatJson(o,a);t.export_json_to_excel({header:n,data:i,filename:e.filename}),e.$refs.multipleTable.clearSelection(),e.downloadLoading=!1})),this.fetchData()):this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},resetForm:function(e){this.$refs[e].resetFields(),this.searchMap={},this.nameList=[],this.argsList=[],this.$message({message:"已清空搜索条件",type:"info"})},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},formatBoolean:function(e){return e?"是":""},fetchData:function(){var e=this;this.listLoading=!0,i["a"].search(this.currentPage,this.pageSize,this.searchMap).then((function(t){e.list=t.data.rows,e.total=t.data.total,e.listLoading=!1}))},handleSave:function(){var e=this,t=!0;if(this.checkedChecktypes&&0!==this.checkedChecktypes.length?this.pojo.validatetype=this.checkedChecktypes.join(","):this.pojo.validatetype=null,"selfd"===this.pojo.type&&(""===this.pojo.plugincode?this.pojo.plugincode=null:this.pojo.plugincode=this.coder.getValue()),i["a"].update(this.id,this.pojo).then((function(n){if(e.$message({message:n.message,type:n.flag?"success":"error"}),n.flag){if(""===e.id){for(var o=0;o<e.selectedServiceList.length;o++)e.handleSaveService(n.data,e.selectedServiceList[o]);for(var a=0;a<e.selectedVersionList.length;a++)e.handleSaveVersion(n.data,e.selectedVersionList[a]);for(var i=0;i<e.selectedVulnkeywordList.length;i++)e.handleSaveVulnkeyword(n.data,e.selectedVulnkeywordList[i]);for(var c=0;c<e.selectedVulnList.length;c++)e.handleSaveVulnPlugin(n.data,e.selectedVulnList[c]);t=!1,e.fetchData(),e.closeDialogForm()}e.fetchData()}})),t&&""!==this.id){for(var n=0;n<this.selectedServiceList.length;n++)this.handleSaveService(this.pojo.id,this.selectedServiceList[n]);for(var o=0;o<this.selectedVersionList.length;o++)this.handleSaveVersion(this.pojo.id,this.selectedVersionList[o]);for(var a=0;a<this.selectedVulnkeywordList.length;a++)this.handleSaveVulnkeyword(this.pojo.id,this.selectedVulnkeywordList[a]);for(var c=0;c<this.selectedVulnList.length;c++)this.handleSaveVulnPlugin(this.pojo.id,this.selectedVulnList[c])}t&&""!==this.id&&this.closeDialogForm(),this.coder&&this.$refs.textarea&&this.coder.toTextArea()},getServiceByPluginId:function(e){var t=this;c["a"].findByPluginId(e).then((function(e){e.flag&&(t.servicePojoList=e.data)}))},getVersionByPluginId:function(e){var t=this;r["a"].findByPluginId(e).then((function(e){e.flag&&(t.versionPojoList=e.data)}))},getVulnkeywordByPluginId:function(e){var t=this;s["a"].findByPluginId(e).then((function(e){e.flag&&(t.vulnkeywordPojoList=e.data)}))},getVulnPluginByPluginId:function(e){var t=this;u["a"].findByPluginId(e).then((function(e){e.flag&&(t.vulnPluginPojoList=e.data)}))},handleEdit:function(e){var t=this;this.servicePojo={},this.versionPojo={},this.vulnkeywordPojo={},this.id=e,this.dialogFormVisible=!0,""!==e?i["a"].findById(e).then((function(n){n.flag&&(t.pojo=n.data,t.pojo.validatetype&&0!==t.pojo.validatetype.length&&(t.checkedChecktypes=t.pojo.validatetype.split(",")),t.getServiceByPluginId(e),t.getVersionByPluginId(e),t.getVulnkeywordByPluginId(e),t.getVulnPluginByPluginId(e))})).then((function(){"selfd"===t.pojo.type&&t.codeMirrorInitialize(t.pojo.plugincode)})):(this.codeMirrorInitialize(this.plugindemocdoe),this.pojo={})},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除已选记录信息, 包括 [插件配置, 资产服务, 资产版本, 漏洞关键词, 漏洞插件配置关联, 任务插件配置], 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){i["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&t.fetchData()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},b=g,v=(n("8b4a"),n("2877")),y=Object(v["a"])(b,o,a,!1,null,null,null);t["default"]=y.exports},"5ad6":function(e,t,n){"use strict";n("99af");var o=n("b775"),a="center",i="pluginconfig";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"get"})},search:function(e,t,n){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:n})},save:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"87b3":function(e,t,n){"use strict";n("99af");var o=n("b775"),a="center",i="pluginassetservice";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"get"})},search:function(e,t,n){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:n})},save:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"get"})},findByPluginId:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/plugin/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"8b4a":function(e,t,n){"use strict";var o=n("f68a"),a=n.n(o);a.a},dce3:function(e,t,n){"use strict";n("99af");var o=n("b775"),a="center",i="vuln";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"get"})},search:function(e,t,n){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:n})},save:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/").concat(e),method:"delete"})},findByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/ids"),method:"post",data:e})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(a,"/").concat(i,"/deleteids"),method:"post",data:e})}}},f68a:function(e,t,n){}}]);