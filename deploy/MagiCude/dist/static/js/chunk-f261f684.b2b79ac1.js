(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-f261f684"],{"0706":function(e,t,a){"use strict";var o=a("5b62"),n=a.n(o);n.a},"24d2":function(e,t,a){"use strict";a("99af");var o=a("b775"),n="center",i="project";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"get"})},search:function(e,t,a){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:a})},save:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"2c57":function(e,t,a){"use strict";a("99af");var o=a("b775"),n="center",i="taskpluginconfig";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"get"})},search:function(e,t,a){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:a})},save:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/deleteids"),method:"post",data:e})},findAllByTaskid:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/task/").concat(e),method:"get"})},addAllByIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/plugin/ids"),method:"post",data:e})},deleteAllByTaskId:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/task/").concat(e),method:"delete"})},deleteAllIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/task/ids"),method:"post",data:e})}}},"5ad6":function(e,t,a){"use strict";a("99af");var o=a("b775"),n="center",i="pluginconfig";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"get"})},search:function(e,t,a){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:a})},save:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/deleteids"),method:"post",data:e})}}},"5b62":function(e,t,a){},a0f1:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("el-collapse",{model:{value:e.activeNames,callback:function(t){e.activeNames=t},expression:"activeNames"}},[a("el-collapse-item",{attrs:{name:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"header-icon el-icon-info"}),e._v("菜单栏隐藏与显示")]),a("el-form",{ref:"searchform",attrs:{inline:"",size:"small",model:e.searchMap}},[a("el-form-item",{attrs:{prop:"projectid",label:"父任务"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请输入关键词"},model:{value:e.searchMap.taskparentid,callback:function(t){e.$set(e.searchMap,"taskparentid",t)},expression:"searchMap.taskparentid"}},e._l(e.list,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{prop:"projectid",label:"项目"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请输入关键词"},model:{value:e.searchMap.projectid,callback:function(t){e.$set(e.searchMap,"projectid",t)},expression:"searchMap.projectid"}},e._l(e.projectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{prop:"name",label:"名称"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getNameListList,loading:e.searchLoading},model:{value:e.searchMap.name,callback:function(t){e.$set(e.searchMap,"name",t)},expression:"searchMap.name"}},e._l(e.nameList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-form-item",{attrs:{prop:"starttime",label:"开始时间"}},[a("el-date-picker",{staticStyle:{width:"350px"},attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","range-separator":"-","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.searchMap.starttime,callback:function(t){e.$set(e.searchMap,"starttime",t)},expression:"searchMap.starttime"}})],1),a("el-form-item",{attrs:{prop:"endtime",label:"结束时间"}},[a("el-date-picker",{staticStyle:{width:"350px"},attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","range-separator":"-","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.searchMap.endtime,callback:function(t){e.$set(e.searchMap,"endtime",t)},expression:"searchMap.endtime"}})],1),a("el-form-item",{attrs:{prop:"worktype",label:"任务类型"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getWorktypeList,loading:e.searchLoading},model:{value:e.searchMap.worktype,callback:function(t){e.$set(e.searchMap,"worktype",t)},expression:"searchMap.worktype"}},e._l(e.worktypeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.worktype,value:e.worktype}})})),1)],1),a("el-form-item",{attrs:{prop:"checktype",label:"检测类型"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getChecktypeList,loading:e.searchLoading},model:{value:e.searchMap.checktype,callback:function(t){e.$set(e.searchMap,"checktype",t)},expression:"searchMap.checktype"}},e._l(e.checktypeList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.checktype,value:e.checktype}})})),1)],1),a("el-form-item",{attrs:{prop:"additionoption",label:"附加选项"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getAdditionoptionList,loading:e.searchLoading},model:{value:e.searchMap.additionoption,callback:function(t){e.$set(e.searchMap,"additionoption",t)},expression:"searchMap.additionoption"}},e._l(e.additionoptionList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.additionoption,value:e.additionoption}})})),1)],1),a("el-form-item",{attrs:{prop:"targetip",label:"目标ip"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getTargetipList,loading:e.searchLoading},model:{value:e.searchMap.targetip,callback:function(t){e.$set(e.searchMap,"targetip",t)},expression:"searchMap.targetip"}},e._l(e.targetipList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.targetip,value:e.targetip}})})),1)],1),a("el-form-item",{attrs:{prop:"targetport",label:"目标端口"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getTargetportList,loading:e.searchLoading},model:{value:e.searchMap.targetport,callback:function(t){e.$set(e.searchMap,"targetport",t)},expression:"searchMap.targetport"}},e._l(e.targetportList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.targetport,value:e.targetport}})})),1)],1),a("el-form-item",{attrs:{prop:"excludeip",label:"排除ip"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getExcludeipList,loading:e.searchLoading},model:{value:e.searchMap.excludeip,callback:function(t){e.$set(e.searchMap,"excludeip",t)},expression:"searchMap.excludeip"}},e._l(e.excludeipList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.excludeip,value:e.excludeip}})})),1)],1),a("el-form-item",{attrs:{prop:"crontask",label:"cron任务"}},[a("el-switch",{model:{value:e.searchMap.crontask,callback:function(t){e.$set(e.searchMap,"crontask",t)},expression:"searchMap.crontask"}})],1),a("el-form-item",{attrs:{prop:"dbipisexcludeip",label:"排除db中ip"}},[a("el-switch",{model:{value:e.searchMap.dbipisexcludeip,callback:function(t){e.$set(e.searchMap,"dbipisexcludeip",t)},expression:"searchMap.dbipisexcludeip"}})],1),a("el-form-item",{attrs:{prop:"merge2asset",label:"结果合并到资产"}},[a("el-switch",{model:{value:e.searchMap.merge2asset,callback:function(t){e.$set(e.searchMap,"merge2asset",t)},expression:"searchMap.merge2asset"}})],1),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{prop:"description",clearable:"",placeholder:"描述"},model:{value:e.searchMap.description,callback:function(t){e.$set(e.searchMap,"description",t)},expression:"searchMap.description"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fetchData()}}},[e._v(" 查询")]),a("el-button",{attrs:{type:"info"},on:{click:function(t){return e.resetForm("searchform")}}},[e._v("重置")]),a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"默认名字：报告",clearable:"","prefix-icon":"el-icon-document"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("el-button",{attrs:{loading:e.downloadLoading,type:"success",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v("导出")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDeleteAll}},[e._v("删除")]),a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit("")}}},[e._v("新增")])],1)],1)],2)],1),a("el-drawer",{attrs:{title:"子任务",visible:e.drawer,"with-header":!1,direction:"rtl",size:"65%","before-close":e.handleDrawerClose},on:{"update:visible":function(t){e.drawer=t}}},[a("el-collapse",{model:{value:e.childActiveNames,callback:function(t){e.childActiveNames=t},expression:"childActiveNames"}},[a("el-collapse-item",{attrs:{name:"1"}},[a("template",{slot:"title"},[a("i",{staticClass:"header-icon el-icon-info"}),e._v("子任务-菜单栏隐藏与显示")]),a("el-form",{ref:"searchformchild",attrs:{inline:"",size:"small",model:e.childSearchMap}},[a("el-form-item",{attrs:{prop:"projectid",label:"项目"}},[a("el-select",{attrs:{filterable:"",clearable:"",placeholder:"请输入关键词"},model:{value:e.childSearchMap.projectid,callback:function(t){e.$set(e.childSearchMap,"projectid",t)},expression:"childSearchMap.projectid"}},e._l(e.projectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{prop:"name",label:"名称"}},[a("el-select",{staticStyle:{width:"150px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getNameListList,loading:e.searchLoading},model:{value:e.childSearchMap.name,callback:function(t){e.$set(e.childSearchMap,"name",t)},expression:"childSearchMap.name"}},e._l(e.nameList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-form-item",{attrs:{prop:"starttime",label:"开始时间"}},[a("el-date-picker",{staticStyle:{width:"350px"},attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","range-separator":"-","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.childSearchMap.starttime,callback:function(t){e.$set(e.childSearchMap,"starttime",t)},expression:"childSearchMap.starttime"}})],1),a("el-form-item",{attrs:{prop:"endtime",label:"结束时间"}},[a("el-date-picker",{staticStyle:{width:"350px"},attrs:{type:"datetimerange","value-format":"yyyy-MM-dd HH:mm:ss","start-placeholder":"开始日期","range-separator":"-","end-placeholder":"结束日期","picker-options":e.pickerOptions},model:{value:e.childSearchMap.endtime,callback:function(t){e.$set(e.childSearchMap,"endtime",t)},expression:"childSearchMap.endtime"}})],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.childFetchData()}}},[e._v(" 查询")]),a("el-button",{attrs:{type:"info"},on:{click:function(t){return e.resetForm("searchformchild")}}},[e._v("重置")]),a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.childHandleDeleteAll}},[e._v("删除")])],1)],1)],2)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.childListLoading,expression:"childListLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.childList,border:"",fit:"","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"selection-change":e.childHandleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),a("el-table-column",{attrs:{label:"序号",type:"index",index:1,align:"center",width:"50"}}),a("el-table-column",{attrs:{sortable:"",prop:"projectid",label:"项目"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getProjectNameById(t.row.projectid))+" ")]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"name",label:"名称"}}),a("el-table-column",{attrs:{sortable:"",prop:"starttime",label:"开始时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateformat")(t.row.starttime))+" ")]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"endtime",label:"结束时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateformat")(t.row.endtime))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"worktype",label:"任务类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.worktype?a("span",[e._v(" "+e._s(t.row.worktype)),a("br"),t.row.checktype?e._e():a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("开始")]),a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-video-play",circle:""},on:{click:function(a){return e.executeTask(t.row.id)}}})],1)],1),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("停止")]),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-video-pause",circle:""},on:{click:function(a){return e.stopTask(t.row.id)}}})],1),a("br"),"nse"!=t.row.worktype&&"selfd"!=t.row.worktype&&"httpp"!=t.row.worktype?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("重新开始")]),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",circle:""},on:{click:function(a){return e.repeatTask(t.row.id)}}})],1)],1):e._e(),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("获取状态")]),a("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.getTaskStatus(t.row.id)}}})],1)],1):e._e()]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"threadnumber",label:"线程数量"}}),a("el-table-column",{attrs:{sortable:"",prop:"additionoption",label:"附加选项"}}),a("el-table-column",{attrs:{sortable:"",prop:"rate",label:"扫描速率"}}),a("el-table-column",{attrs:{sortable:"",prop:"targetip",label:"目标ip","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"targetport",label:"目标端口","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"excludeip",label:"排除ip","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"ipslicesize",label:"ip分组大小"}}),a("el-table-column",{attrs:{sortable:"",prop:"portslicesize",label:"端口分组大小"}}),a("el-table-column",{attrs:{sortable:"",prop:"description",label:"描述","show-overflow-tooltip":""}})],1),a("el-pagination",{attrs:{"current-page":e.childCurrentPage,"page-sizes":[10,20,50,200],"page-size":e.childPageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.childTotal},on:{"update:currentPage":function(t){e.childCurrentPage=t},"update:current-page":function(t){e.childCurrentPage=t},"size-change":e.childHandleSizeChange,"current-change":e.childFetchData}})],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),a("el-table-column",{attrs:{label:"序号",type:"index",index:1,align:"center",width:"50"}}),a("el-table-column",{attrs:{sortable:"",prop:"taskparentid",label:"父任务"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getTaskNameById(t.row.taskparentid))+" ")]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"projectid",label:"项目"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e.getProjectNameById(t.row.projectid))+" ")]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"name",label:"名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[null===t.row.taskparentid?a("span",[a("el-link",{attrs:{underline:!1},on:{click:function(a){return e.handleDrawer(t.row.id)}}},[a("i",{staticClass:"el-icon-view el-icon--right"}),e._v(e._s(t.row.name)+" ")])],1):a("span",[e._v(" "+e._s(t.row.name)+" ")])]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"cronexpression",label:"cron表达式"}}),a("el-table-column",{attrs:{align:"center",sortable:"",label:"cron任务"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.crontask?a("span",[a("span",[e._v(e._s(e.formatBoolean(t.row.crontask)))]),a("br"),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("删除cron任务")]),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.stopScheduleTask(t.row.id)}}})],1)],1):e._e()]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"starttime",label:"开始时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateformat")(t.row.starttime))+" ")]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"endtime",label:"结束时间"},scopedSlots:e._u([{key:"default",fn:function(t){return[e._v(" "+e._s(e._f("dateformat")(t.row.endtime))+" ")]}}])}),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"worktype",label:"任务类型",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.worktype?a("span",[e._v(" "+e._s(t.row.worktype)),a("br"),t.row.checktype?e._e():a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("开始")]),a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-video-play",circle:""},on:{click:function(a){return e.executeTask(t.row.id)}}})],1)],1),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("停止")]),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-video-pause",circle:""},on:{click:function(a){return e.stopTask(t.row.id)}}})],1),a("br"),"nse"!=t.row.worktype&&"selfd"!=t.row.worktype&&"httpp"!=t.row.worktype?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("重新开始")]),a("el-button",{attrs:{size:"mini",icon:"el-icon-refresh",circle:""},on:{click:function(a){return e.repeatTask(t.row.id)}}})],1)],1):e._e(),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("获取状态")]),a("el-button",{attrs:{type:"info",size:"mini",icon:"el-icon-warning-outline",circle:""},on:{click:function(a){return e.getTaskStatus(t.row.id)}}})],1)],1):e._e()]}}])}),a("el-table-column",{attrs:{align:"center",sortable:"",prop:"checktype",label:"检测类型"},scopedSlots:e._u([{key:"default",fn:function(t){return[t.row.checktype?a("span",[e._v(" "+e._s(t.row.checktype)),a("br"),t.row.starttime&&t.row.endtime&&!t.row.taskparentid?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("开始")]),a("el-button",{attrs:{type:"success",size:"mini",icon:"el-icon-video-play",circle:""},on:{click:function(a){return e.executeCheck(t.row.id)}}})],1)],1):e._e()]):e._e()]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"threadnumber",label:"线程数量"}}),a("el-table-column",{attrs:{sortable:"",prop:"singleipscantime",label:"ip扫描次数"}}),a("el-table-column",{attrs:{sortable:"",prop:"additionoption",label:"附加选项"}}),a("el-table-column",{attrs:{sortable:"",prop:"rate",label:"扫描速率"}}),a("el-table-column",{attrs:{sortable:"",prop:"targetip",label:"目标ip","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"targetport",label:"目标端口","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"excludeip",label:"排除ip","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"ipslicesize",label:"ip分组大小"}}),a("el-table-column",{attrs:{sortable:"",prop:"portslicesize",label:"端口分组大小"}}),a("el-table-column",{attrs:{align:"center",sortable:"",label:"排除db中ip"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatBoolean(t.row.dbipisexcludeip)))])]}}])}),a("el-table-column",{attrs:{align:"center",sortable:"",label:"结果合并到资产"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",[e._v(e._s(e.formatBoolean(t.row.merge2asset)))])]}}])}),a("el-table-column",{attrs:{sortable:"",prop:"description",label:"描述","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.row.id)}}}),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.handleDelete(t.row.id)}}})]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,200,500,1e3],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.handleSizeChange,"current-change":e.fetchData}}),a("el-dialog",{attrs:{title:"编辑",visible:e.dialogFormVisible,width:"50%",center:"","before-close":e.cleanCache},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"父任务"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"请输入关键词"},model:{value:e.pojo.taskparentid,callback:function(t){e.$set(e.pojo,"taskparentid",t)},expression:"pojo.taskparentid"}},e._l(e.list,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"项目"}},[a("el-select",{staticStyle:{width:"400px"},attrs:{filterable:"",clearable:"",placeholder:"请输入关键词"},model:{value:e.pojo.projectid,callback:function(t){e.$set(e.pojo,"projectid",t)},expression:"pojo.projectid"}},e._l(e.projectList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.id}})})),1)],1),a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{attrs:{clearable:""},model:{value:e.pojo.name,callback:function(t){e.$set(e.pojo,"name",t)},expression:"pojo.name"}})],1),e.pojo.id?a("span",[a("el-form-item",{attrs:{label:"时间"}},[a("el-date-picker",{attrs:{placeholder:"开始时间",type:"datetime"},model:{value:e.pojo.starttime,callback:function(t){e.$set(e.pojo,"starttime",t)},expression:"pojo.starttime"}}),a("el-date-picker",{attrs:{placeholder:"结束时间",type:"datetime"},model:{value:e.pojo.endtime,callback:function(t){e.$set(e.pojo,"endtime",t)},expression:"pojo.endtime"}})],1)],1):e._e(),a("el-form-item",{attrs:{required:"",label:"任务类型"}},[null!=e.pojo.id?a("span",[a("span",[e._v(e._s(e.pojo.worktype))])]):a("span",[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.pojo.worktype,callback:function(t){e.$set(e.pojo,"worktype",t)},expression:"pojo.worktype"}},[a("el-radio-button",{attrs:{label:"nmap"}}),a("el-radio-button",{attrs:{label:"mass"}}),a("el-radio-button",{attrs:{label:"mass2Nmap"}}),a("el-radio-button",{attrs:{label:"nse"}}),a("el-radio-button",{attrs:{label:"selfd"}}),a("el-radio-button",{attrs:{label:"httpp"}})],1)],1)]),e.pojo.worktype&&"mass2Nmap"==e.pojo.worktype?a("span",[a("el-form-item",{attrs:{label:"Nmap配置",size:"mini"}},[a("el-form-item",{attrs:{label:"线程数量",size:"mini"}},[a("el-input-number",{attrs:{min:1,placeholder:"默认10"},model:{value:e.nmapPojo.threadnumber,callback:function(t){e.$set(e.nmapPojo,"threadnumber",t)},expression:"nmapPojo.threadnumber"}})],1),a("el-form-item",{attrs:{label:"ip扫描次数",size:"mini"}},[a("el-input-number",{attrs:{min:1,placeholder:"默认1"},model:{value:e.nmapPojo.singleipscantime,callback:function(t){e.$set(e.nmapPojo,"singleipscantime",t)},expression:"nmapPojo.singleipscantime"}})],1),a("el-form-item",{attrs:{label:"附加选项",size:"mini"}},[a("el-input",{attrs:{placeholder:"默认-Pn -n -sV --max-retries=1"},model:{value:e.nmapPojo.additionoption,callback:function(t){e.$set(e.nmapPojo,"additionoption",t)},expression:"nmapPojo.additionoption"}})],1)],1)],1):e._e(),e.pojo.taskparentid||"nmap"!=e.pojo.worktype&&"mass2Nmap"!=e.pojo.worktype||null==e.pojo.starttime||null==e.pojo.endtime?e._e():a("span",[a("el-form-item",{attrs:{label:"检测类型",inline:""}},[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("保存后再重新编辑, 才能配置插件")]),a("el-checkbox-group",{attrs:{size:"mini"},model:{value:e.checkedChecktypes,callback:function(t){e.checkedChecktypes=t},expression:"checkedChecktypes"}},e._l(e.checks,(function(e){return a("el-checkbox-button",{key:e,attrs:{label:e}})})),1)],1)],1)],1),a("el-form-item",{attrs:{label:"数量",inline:""}},["nse"==e.pojo.worktype||"selfd"==e.pojo.worktype||"httpp"==e.pojo.worktype?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("线程数量"),a("br"),e._v("默认4")]),a("el-input-number",{attrs:{min:1,size:"small",placeholder:"线程数量"},model:{value:e.pojo.threadnumber,callback:function(t){e.$set(e.pojo,"threadnumber",t)},expression:"pojo.threadnumber"}})],1)],1):a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("线程数量"),a("br"),e._v("默认4")]),a("el-input-number",{attrs:{min:1,size:"small",placeholder:"线程数量"},model:{value:e.pojo.threadnumber,callback:function(t){e.$set(e.pojo,"threadnumber",t)},expression:"pojo.threadnumber"}})],1),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("单ip扫描次数"),a("br"),e._v("默认1")]),a("el-input-number",{attrs:{min:1,size:"small",placeholder:"单ip扫描次数"},model:{value:e.pojo.singleipscantime,callback:function(t){e.$set(e.pojo,"singleipscantime",t)},expression:"pojo.singleipscantime"}})],1),"mass2Nmap"==e.pojo.worktype||"mass"==e.pojo.worktype?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("mass扫描速率"),a("br"),e._v("只对mass,mass2Nmap模式有效"),a("br"),e._v("默认1000")]),a("el-input-number",{attrs:{min:100,size:"small",step:1e3,placeholder:"mass速率"},model:{value:e.pojo.rate,callback:function(t){e.$set(e.pojo,"rate",t)},expression:"pojo.rate"}})],1)],1):e._e(),"unknownPortSerVer"!==e.pojo.targetip&&"ipAllPort"!==e.pojo.targetip?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("ip分组大小"),a("br"),e._v("默认255")]),a("el-input-number",{attrs:{min:1,size:"small",placeholder:"ip分组大小"},model:{value:e.pojo.ipslicesize,callback:function(t){e.$set(e.pojo,"ipslicesize",t)},expression:"pojo.ipslicesize"}})],1)],1):e._e(),"nmap"!=e.pojo.worktype||null!=e.pojo.targetport&&""!=e.pojo.targetport||"unknownPortSerVer"===e.pojo.targetip||"ipAllPort"===e.pojo.targetip?e._e():a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("端口分组大小"),a("br"),e._v("只对nmap全端口模式有效"),a("br"),e._v("范围：1000-10000"),a("br"),e._v("默认1000")]),a("el-input-number",{attrs:{min:1e3,max:1e4,step:1e3,size:"small",placeholder:"端口分组大小"},model:{value:e.pojo.portslicesize,callback:function(t){e.$set(e.pojo,"portslicesize",t)},expression:"pojo.portslicesize"}})],1)],1)],1)]),"nmap"==e.pojo.worktype||"mass2Nmap"==e.pojo.worktype||"mass"==e.pojo.worktype||"nse"==e.pojo.worktype?a("span",[a("el-form-item",{attrs:{label:"附加选项"}},[a("el-input",{attrs:{clearable:"",placeholder:"nmap/nse默认-Pn -n -sV --max-retries=1 --open，mass/mass2Nmap无默认"},model:{value:e.pojo.additionoption,callback:function(t){e.$set(e.pojo,"additionoption",t)},expression:"pojo.additionoption"}})],1)],1):e._e(),"nse"==e.pojo.worktype||"selfd"==e.pojo.worktype||"httpp"==e.pojo.worktype?a("span",[e.pojo.taskparentid?a("span",[a("el-form-item",{attrs:{required:"",label:"目标ip"}},[a("span",[e._v(e._s(e.pojo.targetip))])])],1):a("span",[a("el-form-item",{attrs:{required:"",label:"目标ip"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.pojo.targetip,callback:function(t){e.$set(e.pojo,"targetip",t)},expression:"pojo.targetip"}},[a("el-radio-button",{attrs:{label:"assetip"}})],1)],1)],1)]):a("span",["nmap"!=e.pojo.worktype||null!=e.pojo.targetip&&""!=e.pojo.targetip?e._e():a("span",[a("el-form-item",{attrs:{required:"",label:"目标ip"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.pojo.targetip,callback:function(t){e.$set(e.pojo,"targetip",t)},expression:"pojo.targetip"}},[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("数据库中所有没有端口且未下线的ip")]),a("el-radio-button",{attrs:{label:"ipNoPort"}})],1),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("更新"),a("br"),e._v("端口service [为空, null, tcpwrapped, unknown, 包含?] 的ip"),a("br"),e._v("端口version [为空, null] 的ip"),a("br"),e._v("的service和version")]),a("el-radio-button",{attrs:{label:"unknownPortSerVer"}})],1),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("更新资产库所有ip的端口信息")]),a("el-radio-button",{attrs:{label:"ipAllPort"}})],1)],1)],1)],1),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("格式1: assetip或ipNoPort或unknownPortSerVer或ipAllPort"),a("br"),e._v("格式2:192.168.1.1,192.168.2.1-192.168.2.100,192.168.3.0/24 "),a("br"),e._v("格式说明: assetip代表数据库中所有未下线的ip, 仅在nse/selfd/httpp模式下生效"),a("br"),e._v("如果是assetip或ipNoPort或unknownPortSerVer或ipAllPort, 则不能再配置具体ip "),a("br"),e._v("ipNoPort及unknownPortSerVer说明见上 ")]),a("el-form-item",{attrs:{required:"",label:"目标ip"}},[a("el-input",{attrs:{clearable:"",autosize:{maxRows:10},type:"textarea",placeholder:"格式:assetip或单个ip,ip段,CIDR, 举例: assetip或192.168.1.1,192.168.2.1-192.168.2.100,192.168.3.0/24"},model:{value:e.pojo.targetip,callback:function(t){e.$set(e.pojo,"targetip",t)},expression:"pojo.targetip"}})],1)],1)],1),"nmap"!=e.pojo.worktype||null!=e.pojo.portslicesize&&""!=e.pojo.portslicesize||"unknownPortSerVer"===e.pojo.targetip||"ipAllPort"===e.pojo.targetip?e._e():a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("格式1: "),a("br"),e._v("格式2:regular"),a("br"),e._v("格式3:80,443,1-1001"),a("br"),e._v("格式说明: 为空代表所有端口, regular为nmap默认端口")]),a("el-form-item",{attrs:{label:"目标端口"}},[a("el-input",{attrs:{clearable:"",autosize:{maxRows:10},type:"textarea",placeholder:"格式: 留空或regular或80,443,1-1001"},model:{value:e.pojo.targetport,callback:function(t){e.$set(e.pojo,"targetport",t)},expression:"pojo.targetport"}})],1)],1)],1),"mass"==e.pojo.worktype||"mass2Nmap"==e.pojo.worktype?a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("格式1: "),a("br"),e._v("格式2:regular"),a("br"),e._v("格式3:80,443,1-1001"),a("br"),e._v("格式说明: 为空代表所有端口, regular为nmap默认端口")]),a("el-form-item",{attrs:{label:"目标端口"}},[a("el-input",{attrs:{clearable:"",autosize:{maxRows:10},type:"textarea",placeholder:"格式: 留空或regular或80,443,1-1001"},model:{value:e.pojo.targetport,callback:function(t){e.$set(e.pojo,"targetport",t)},expression:"pojo.targetport"}})],1)],1)],1):e._e(),"nmap"!=e.pojo.worktype&&"mass2Nmap"!=e.pojo.worktype&&"mass"!=e.pojo.worktype||"unknownPortSerVer"===e.pojo.targetip||"ipAllPort"===e.pojo.targetip?e._e():a("span",[a("el-form-item",{attrs:{label:"排除ip"}},[a("el-input",{attrs:{clearable:"",autosize:{maxRows:10},type:"textarea",placeholder:"格式:单个ip,ip段,CIDR,举例: 192.168.1.1,192.168.2.1-192.168.2.100,192.168.3.0/24"},model:{value:e.pojo.excludeip,callback:function(t){e.$set(e.pojo,"excludeip",t)},expression:"pojo.excludeip"}})],1)],1),a("el-form-item",{attrs:{label:"Boolean"}},[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("默认false"),a("br"),e._v("cron任务需要手动点开始")]),a("el-switch",{attrs:{"active-text":"cron任务"},model:{value:e.pojo.crontask,callback:function(t){e.$set(e.pojo,"crontask",t)},expression:"pojo.crontask"}})],1),"nmap"!=e.pojo.worktype&&"mass2Nmap"!=e.pojo.worktype&&"mass"!=e.pojo.worktype||"unknownPortSerVer"===e.pojo.targetip||"ipAllPort"===e.pojo.targetip||"ipNoPort"===e.pojo.targetip?e._e():a("span",[a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("默认false")]),a("el-switch",{attrs:{"active-text":"排除db中ip"},model:{value:e.pojo.dbipisexcludeip,callback:function(t){e.$set(e.pojo,"dbipisexcludeip",t)},expression:"pojo.dbipisexcludeip"}})],1)],1),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("默认true")]),a("el-switch",{attrs:{"active-text":"结果合并到资产"},model:{value:e.pojo.merge2asset,callback:function(t){e.$set(e.pojo,"merge2asset",t)},expression:"pojo.merge2asset"}})],1)],1),!0===e.pojo.crontask?a("span",[a("el-form-item",{attrs:{required:"",label:"cron表达式"}},[a("el-input",{staticStyle:{width:"400px"},attrs:{clearable:""},model:{value:e.pojo.cronexpression,callback:function(t){e.$set(e.pojo,"cronexpression",t)},expression:"pojo.cronexpression"}})],1)],1):e._e(),a("el-form-item",{attrs:{label:"描述"}},[a("el-input",{attrs:{autosize:"",type:"textarea"},model:{value:e.pojo.description,callback:function(t){e.$set(e.pojo,"description",t)},expression:"pojo.description"}})],1),"nse"==e.pojo.worktype||"selfd"==e.pojo.worktype||("nmap"==e.pojo.worktype||"mass2Nmap"==e.pojo.worktype||"mass"==e.pojo.worktype)&&e.pojo.checktype&&"httpp"!=e.pojo.checktype?a("span",[a("el-divider"),null==e.pojo.id?a("span",[a("el-form-item",{attrs:{label:"插件"}},[a("b",[e._v("保存任务后才能启用插件")])])],1):e._e(),!e.pojo.id||e.pojo.taskparentid&&e.pojo.checktype?e._e():a("span",[a("el-form-item",{attrs:{label:"插件"}},[0==e.taskPluginPojoList.length?a("span",[e.pojo.checktype?a("span",[a("span",[a("b",[e._v("当前未选择插件, 默认启用 "+e._s(e.pojo.checktype.replace(",httpp","").replace("httpp,",""))+" 类型的所有插件")])])]):a("span",[a("span",[a("b",[e._v("当前未选择插件, 默认启用 "+e._s(e.pojo.worktype)+" 类型的所有插件")])])])]):e._e(),a("el-form",{ref:"searchform2",attrs:{inline:"",size:"mini",model:e.searchMap}},[a("el-form-item",{attrs:{prop:"name",label:"名称"}},[a("el-select",{staticStyle:{width:"130px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getNameList,loading:e.searchLoading},model:{value:e.searchMap.name,callback:function(t){e.$set(e.searchMap,"name",t)},expression:"searchMap.name"}},e._l(e.pluginnameList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-form-item",{attrs:{prop:"args",label:"参数"}},[a("el-select",{staticStyle:{width:"130px"},attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getArgsList,loading:e.searchLoading},model:{value:e.searchMap.args,callback:function(t){e.$set(e.searchMap,"args",t)},expression:"searchMap.args"}},e._l(e.argsList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.args,value:e.args}})})),1)],1),a("el-form-item",{attrs:{label:"风险"}},[a("el-select",{staticStyle:{width:"90px"},attrs:{placeholder:"请选择",clearable:""},model:{value:e.searchMap.risk,callback:function(t){e.$set(e.searchMap,"risk",t)},expression:"searchMap.risk"}},e._l(e.options,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1),e.pojo.checktype?a("span",[a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.searchMap.type,callback:function(t){e.$set(e.searchMap,"type",t)},expression:"searchMap.type"}},[a("el-radio-button",{attrs:{label:"selfd"}}),a("el-radio-button",{attrs:{label:"nse"}})],1)],1)],1):e._e(),a("el-form-item",[a("el-button",{attrs:{type:"primary",size:"mini"},on:{click:function(t){return e.fetchPluginconfigData()}}},[e._v("查询")]),a("el-button",{attrs:{type:"info",size:"mini"},on:{click:function(t){return e.resetForm("searchform2")}}},[e._v("重置")]),a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(t){return e.enablePlugin(e.pojo.id)}}},[e._v("启用")]),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("不选择插件, 则禁用所有已启用插件")]),a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(t){return e.disablePlugin(e.pojo.id)}}},[e._v("禁用")])],1)],1)],1),a("el-table",{ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.pluginconfigList,fit:"",size:"medium"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),a("el-table-column",{attrs:{label:"序号",type:"index",index:1,align:"center",width:"50"}}),a("el-table-column",{attrs:{sortable:"",prop:"name",label:"名称"}}),a("el-table-column",{attrs:{sortable:"",prop:"args",label:"参数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"risk",label:"风险"}}),a("el-table-column",{attrs:{sortable:"",prop:"type",label:"类型"}}),a("el-table-column",{attrs:{label:"操作",width:"140"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.checkPlugin(t.row.id)?a("span",[a("el-button",{attrs:{type:"success",size:"mini"},on:{click:function(a){return e.enablePluginById(e.pojo.id,t.row.id)}}},[e._v("启用")])],1):a("span",[a("el-button",{attrs:{type:"danger",size:"mini"},on:{click:function(a){return e.handleDeleteTaskPluginById(e.pojo.id,t.row.id)}}},[e._v("禁用")])],1)]}}],null,!1,2461043030)})],1),a("el-pagination",{attrs:{"current-page":e.pluginconfigcurrentPage,"page-sizes":[5,15,20,100,200],"page-size":e.pluginconfigpageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.pluginconfigtotal},on:{"update:currentPage":function(t){e.pluginconfigcurrentPage=t},"update:current-page":function(t){e.pluginconfigcurrentPage=t},"size-change":e.handlePluginconfigSizeChange,"current-change":e.fetchPluginconfigData}})],1)],1)],1):e._e()],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSave()}}},[e._v("保存")]),a("el-button",{on:{click:function(t){return e.closeDialogForm()}}},[e._v("关闭")])],1)],1)],1)},n=[],i=(a("4de4"),a("c975"),a("a15b"),a("d81d"),a("b0c0"),a("4ec9"),a("d3b7"),a("ac1f"),a("3ca3"),a("841c"),a("1276"),a("ddb0"),a("b199")),l=a("24d2"),r=a("b19b"),s=a("2c57"),c=a("5ad6"),p=a("2b0e"),u=p["default"].filter("dateformat"),d=["nse","selfd","httpp"],m={data:function(){return{list:[],total:0,currentPage:1,pageSize:10,searchMap:{},dialogFormVisible:!1,pojo:{},id:"",searchLoading:!1,filename:"",listLoading:!0,multipleSelection:[],downloadLoading:!1,checkedChecktypes:[],checks:d,projectList:[],projectnameList:[],taskInMap:new Map,projectIpMap:new Map,nameList:[],worktypeList:[],checktypeList:[],additionoptionList:[],targetipList:[],targetportList:[],excludeipList:[],tastStatusList:[],nmapconfigId:"",nmapPojo:{},taskPluginPojoList:[],pluginMap:new Map,pluginconfigList:[],pluginconfigtotal:0,pluginconfigcurrentPage:1,pluginconfigpageSize:5,taskPluginList:[],argsList:[],pluginnameList:[],temptaskid:"",tempList:[],activeNames:["1"],drawer:!1,childActiveNames:["1"],childList:[],childListLoading:!0,childCurrentPage:1,childPageSize:10,childTotal:0,childMultipleSelection:[],childSearchMap:{},options:[{value:"信息",label:"信息"},{value:"低危",label:"低危"},{value:"中危",label:"中危"},{value:"高危",label:"高危"},{value:"严重",label:"严重"},{value:"致命",label:"致命"}],value:"",pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-6048e5),e.$emit("pick",[a,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-2592e6),e.$emit("pick",[a,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-7776e6),e.$emit("pick",[a,t])}},{text:"最近半年",onClick:function(e){var t=new Date,a=new Date;a.setTime(a.getTime()-15552e6),e.$emit("pick",[a,t])}}]}}},created:function(){this.fetchData(),this.getProject()},methods:{handleDrawerClose:function(){this.drawer=!1,this.childPageSize=10,this.childCurrentPage=1,this.childMultipleSelection=[],this.childSearchMap={}},handleDrawer:function(e){this.id=e,this.drawer=!0,this.childFetchData()},childFetchData:function(){var e=this;this.childSearchMap.taskparentid=this.id,i["a"].search(this.childCurrentPage,this.childPageSize,this.childSearchMap).then((function(t){e.childList=t.data.rows,e.childTotal=t.data.total,e.childListLoading=!1;for(var a=0;a<e.childList.length;a++)e.taskInMap.set(e.childList[a].id,e.childList[a].name)}))},handleDeleteTaskPluginById:function(e,t){var a=this,o=[];o.push(e),o.push(t),s["a"].deleteAllIds(o).then((function(e){a.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(a.taskPluginList=[],a.refreshPluginName(),a.handleEdit(a.id))}))},enablePluginById:function(e,t){var a=this,o=[];o.push(e),o.push(t),s["a"].addAllByIds(o).then((function(e){a.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(a.taskPluginList=[],a.refreshPluginName(),a.handleEdit(a.id))}))},checkPlugin:function(e){return-1===this.taskPluginList.indexOf(e)},fetchPluginconfigData:function(){var e=this;this.pojo.checktype||(this.searchMap.type=this.pojo.worktype),c["a"].search(this.pluginconfigcurrentPage,this.pluginconfigpageSize,this.searchMap).then((function(t){e.pluginconfigList=t.data.rows,e.pluginconfigtotal=t.data.total}))},getArgsList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,c["a"].search(1,10,{args:e}).then((function(a){t.argsList=a.data.rows.filter((function(t){return t.args.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.argsList=[]},getNameList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,c["a"].search(1,10,{name:e}).then((function(a){t.pluginnameList=a.data.rows.filter((function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.pluginnameList=[]},enablePlugin:function(e){var t=this;if(this.multipleSelection&&this.multipleSelection.length){console.log(e);var a=[];a.push(e);for(var o=0;o<this.multipleSelection.length;o++)a.push(this.multipleSelection[o].id);s["a"].addAllByIds(a).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(t.taskPluginList=[],t.refreshPluginName(),t.handleEdit(t.id))})),this.$refs.multipleTable.clearSelection()}else this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},disablePlugin:function(e){var t=this;this.$confirm("此操作将禁用已选插件, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){if(t.multipleSelection&&t.multipleSelection.length){var a=[];a.push(e);for(var o=0;o<t.multipleSelection.length;o++)a.push(t.multipleSelection[o].id);s["a"].deleteAllIds(a).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(t.taskPluginList=[],t.refreshPluginName(),t.handleEdit(t.id))})),t.$refs.multipleTable.clearSelection()}else s["a"].deleteAllByTaskId(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&(t.taskPluginList=[],t.refreshPluginName(),t.handleEdit(t.id))}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},handleDeleteTaskPlugin:function(e){var t=this;console.log(e),this.$confirm("此操作将禁用已选插件, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){s["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&t.handleEdit(t.id)}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))},refreshPluginName:function(e){this.getTaskPluginByTaskId(e)},getPluginName:function(e){return this.pluginMap.get(e)},getTaskPluginByTaskId:function(e){var t=this;s["a"].findAllByTaskid(e).then((function(e){e.flag&&(t.taskPluginPojoList=e.data)})).then((function(){for(var e=function(e){c["a"].findById(t.taskPluginPojoList[e].pluginconfigid).then((function(a){t.taskPluginList.push(t.taskPluginPojoList[e].pluginconfigid),t.pluginMap.set(a.data.id,a.data.name)}))},a=0;a<t.taskPluginPojoList.length;a++)e(a)}))},cleanCache:function(){this.closeDialogForm()},getNmapConfigByTaskId:function(e){var t=this;""!==e?r["a"].findByTaskId(e).then((function(e){e.flag&&(t.nmapPojo=e.data)})):this.nmapPojo={}},executeTask:function(e){var t=this;i["a"].executeTask(e).then((function(e){t.$notify({message:e.data,type:e.flag?"success":"error",duration:5e3}),e.flag&&(t.childFetchData(),t.fetchData())}))},executeCheck:function(e){var t=this;i["a"].executeCheck(e).then((function(e){t.$notify({message:e.data,type:e.flag?"success":"error",duration:5e3}),e.flag&&(t.childFetchData(),t.fetchData())}))},stopTask:function(e){var t=this;this.$confirm("此操作将停止任务并删除cron任务(如果有子任务, 子任务也会被停止), 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){i["a"].stopTask(e).then((function(e){t.$notify({message:e.data,type:e.flag?"success":"error",duration:5e3}),e.flag&&(t.childFetchData(),t.fetchData())}))})).catch((function(){t.$message({type:"info",message:"已取消"})}))},repeatTask:function(e){var t=this;i["a"].repeatTask(e).then((function(e){t.$notify({message:e.data,type:e.flag?"success":"error",duration:5e3}),e.flag&&(t.childFetchData(),t.fetchData())}))},stopScheduleTask:function(e){var t=this;i["a"].stopScheduleTask(e).then((function(e){t.$notify({message:e.data,type:e.flag?"success":"error",duration:5e3}),e.flag&&(t.childFetchData(),t.fetchData())}))},getTaskStatus:function(e){var t=this;i["a"].getTaskStatus(e).then((function(e){t.$notify({message:e.data,type:e.flag?"success":"error",duration:5e3}),e.flag&&(t.childFetchData(),t.fetchData())}))},getNameListList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{name:e}).then((function(a){t.nameList=a.data.rows.filter((function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.nameList=[]},getWorktypeList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{worktype:e}).then((function(a){t.worktypeList=a.data.rows.filter((function(t){return t.worktype.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.worktypeList=[]},getChecktypeList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{checktype:e}).then((function(a){t.checktypeList=a.data.rows.filter((function(t){return t.checktype.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.checktypeList=[]},getAdditionoptionList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{additionoption:e}).then((function(a){t.additionoptionList=a.data.rows.filter((function(t){return t.additionoption.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.additionoptionList=[]},getTargetipList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{targetip:e}).then((function(a){t.targetipList=a.data.rows.filter((function(t){return t.targetip.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.ipaddrtargetipListessv6List=[]},getTargetportList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{targetport:e}).then((function(a){t.targetportList=a.data.rows.filter((function(t){return t.targetport.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.targetportList=[]},getExcludeipList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,i["a"].search(1,10,{excludeip:e}).then((function(a){t.excludeipList=a.data.rows.filter((function(t){return t.excludeip.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.excludeipList=[]},getProjectnameList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,l["a"].search(1,10,{name:e}).then((function(a){t.projectnameList=a.data.rows.filter((function(t){return t.ipaddressv4.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.projectnameList=[]},getProjectNameById:function(e){return this.projectIpMap.get(e)},getTaskNameById:function(e){return this.taskInMap.get(e)},getProject:function(){var e=this;l["a"].getList().then((function(t){e.projectList=t.data;for(var a=0;a<e.projectList.length;a++)e.projectIpMap.set(e.projectList[a].id,e.projectList[a].name)}))},handleCheckedChange:function(e){return e},closeDialogForm:function(){this.dialogFormVisible=!1,this.searchMap={},this.nameList=[],this.worktypeList=[],this.checktypeList=[],this.additionoptionList=[],this.targetipList=[],this.targetportList=[],this.excludeipList=[],this.pluginnameList=[],this.argsList=[],this.pluginconfigpageSize=5,this.pluginconfigcurrentPage=1,this.checkedChecktypes=[],this.taskPluginList=[]},childHandleDeleteAll:function(){var e=this;this.childMultipleSelection&&this.childMultipleSelection.length?this.$confirm("此操作将永久删除已选记录, 包括任务插件配置, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){for(var t=[],a=0;a<e.childMultipleSelection.length;a++)t.push(e.childMultipleSelection[a].id);i["a"].deleteAllByIds(t).then((function(t){e.$message({message:t.message,type:t.flag?"success":"error"}),t.flag&&(e.childFetchData(),e.fetchData())}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},handleDeleteAll:function(){var e=this;this.multipleSelection&&this.multipleSelection.length?this.$confirm("此操作将永久删除已选记录, 包括任务插件配置, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){for(var t=[],a=0;a<e.multipleSelection.length;a++)t.push(e.multipleSelection[a].id);i["a"].deleteAllByIds(t).then((function(t){e.$message({message:t.message,type:t.flag?"success":"error"}),t.flag&&e.fetchData()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},handleSelectionChange:function(e){this.multipleSelection=e},childHandleSelectionChange:function(e){this.childMultipleSelection=e},handleDownload:function(){var e=this;this.multipleSelection&&this.multipleSelection.length?(this.downloadLoading=!0,Promise.all([a.e("chunk-3c2d6792"),a.e("chunk-ee77943a")]).then(a.bind(null,"4bf8")).then((function(t){for(var a=["父任务","项目","名称","cron表达式","cron任务","开始时间","结束时间","任务类型","检测类型","线程数量","ip扫描次数","附加选项","扫描速率","目标ip","目标端口","排除ip","ip分组大小","端口分组大小","排除db中ip","结果合并到资产","描述"],o=["taskparentid","projectid","name","cronexpression","crontask","starttime","endtime","worktype","checktype","threadnumber","singleipscantime","additionoption","rate","targetip","targetport","excludeip","ipslicesize","portslicesize","dbipisexcludeip","merge2asset","description"],n=e.multipleSelection,i=0;i<n.length;i++)n[i].taskparentid=e.getTaskNameById(n[i].taskparentid),n[i].projectid=e.getProjectNameById(n[i].projectid),n[i].starttime=u(n[i].starttime),n[i].endtime=u(n[i].endtime),n[i].crontask=n[i].crontask?"是":"",n[i].dbipisexcludeip=n[i].dbipisexcludeip?"是":"",n[i].merge2asset=n[i].merge2asset?"是":"";var l=e.formatJson(o,n);t.export_json_to_excel({header:a,data:l,filename:e.filename}),e.$refs.multipleTable.clearSelection(),e.downloadLoading=!1})),this.fetchData()):this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},resetForm:function(e){this.$refs[e].resetFields(),this.searchMap={},this.childSearchMap={},this.nameList=[],this.worktypeList=[],this.checktypeList=[],this.additionoptionList=[],this.targetipList=[],this.targetportList=[],this.excludeipList=[],this.pluginnameList=[],this.argsList=[],this.$message({message:"已清空搜索条件",type:"info"})},handlePluginconfigSizeChange:function(e){this.pluginconfigpageSize=e,this.fetchPluginconfigData()},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},childHandleSizeChange:function(e){this.childPageSize=e,this.childFetchData()},formatBoolean:function(e){return e?"是":""},fetchData:function(){var e=this;this.listLoading=!0,i["a"].search(this.currentPage,this.pageSize,this.searchMap).then((function(t){e.list=t.data.rows,e.total=t.data.total,e.listLoading=!1;for(var a=0;a<e.list.length;a++)e.taskInMap.set(e.list[a].id,e.list[a].name)}))},handleSave:function(){var e=this;"nmap"!==this.pojo.worktype&&"mass2Nmap"!==this.pojo.worktype||null==this.pojo.starttime||null==this.pojo.endtime||(this.checkedChecktypes&&0!==this.checkedChecktypes.length?this.pojo.checktype=this.checkedChecktypes.join(","):this.pojo.checktype=null),i["a"].update(this.id,this.pojo).then((function(t){"mass2Nmap"!==e.pojo.worktype&&"selfd"!==e.pojo.worktype&&"nse"!==e.pojo.worktype||(""===e.id?(e.nmapPojo.taskid=t.data,e.temptaskid=t.data):(e.nmapPojo.taskid=e.id,e.temptaskid=e.id),"mass2Nmap"===e.pojo.worktype&&(r["a"].updateByTaskId("",e.nmapPojo),e.nmapPojo={})),e.$message({message:t.message,type:t.flag?"success":"error"}),t.flag&&e.fetchData()})).then((function(){"selfd"===e.pojo.worktype||"nse"===e.pojo.worktype?e.handleEdit(e.temptaskid):e.closeDialogForm()}))},handleEdit:function(e){var t=this;this.nmapPojo={},this.id=e,this.dialogFormVisible=!0,""!==e?i["a"].findById(e).then((function(a){a.flag&&(t.pojo=a.data,"nmap"!==t.pojo.worktype&&"mass2Nmap"!==t.pojo.worktype||null==t.pojo.starttime||null==t.pojo.endtime||t.pojo.checktype&&0!==t.pojo.checktype.length&&(t.checkedChecktypes=t.pojo.checktype.split(",")),t.fetchPluginconfigData(),"mass2Nmap"===t.pojo.worktype&&t.getNmapConfigByTaskId(e),t.getTaskPluginByTaskId(e))})):this.pojo={}},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除已选记录, 包括任务插件配置, 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){i["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&t.fetchData()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},h=m,f=(a("0706"),a("2877")),g=Object(f["a"])(h,o,n,!1,null,null,null);t["default"]=g.exports},b199:function(e,t,a){"use strict";a("99af");var o=a("b775"),n="center",i="task";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"get"})},search:function(e,t,a){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:a})},findSearch:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/search"),method:"post",data:e})},save:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"delete"})},executeTask:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/execute/").concat(e),method:"get"})},executeCheck:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/execute/check/").concat(e),method:"get"})},stopTask:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/stop/").concat(e),method:"get"})},repeatTask:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/repeat/").concat(e),method:"get"})},stopScheduleTask:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/schedule/").concat(e),method:"delete"})},getTaskStatus:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/status/").concat(e),method:"get"})},deleteTaskCache:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/cache/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/deleteids"),method:"post",data:e})}}},b19b:function(e,t,a){"use strict";a("99af");var o=a("b775"),n="center",i="nmapconfig";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"get"})},search:function(e,t,a){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:a})},save:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"get"})},findByTaskId:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/task/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"put",data:t})},updateByTaskId:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/deleteids"),method:"post",data:e})}}}}]);