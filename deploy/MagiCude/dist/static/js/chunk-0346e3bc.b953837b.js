(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-0346e3bc"],{2709:function(e,t,a){},"44d8":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{padding:"5px"}},[a("br"),a("el-form",{ref:"searchform",attrs:{inline:"",size:"small",model:e.searchMap}},[a("el-form-item",{attrs:{prop:"name",label:"名称"}},[a("el-select",{attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getNameList,loading:e.searchLoading},model:{value:e.searchMap.name,callback:function(t){e.$set(e.searchMap,"name",t)},expression:"searchMap.name"}},e._l(e.nameList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.name,value:e.name}})})),1)],1),a("el-form-item",{attrs:{prop:"args",label:"参数"}},[a("el-select",{attrs:{filterable:"",remote:"","allow-create":"","default-first-option":"",clearable:"",placeholder:"请输入关键词","remote-method":e.getArgsList,loading:e.searchLoading},model:{value:e.searchMap.args,callback:function(t){e.$set(e.searchMap,"args",t)},expression:"searchMap.args"}},e._l(e.argsList,(function(e){return a("el-option",{key:e.id,attrs:{label:e.args,value:e.args}})})),1)],1),a("el-form-item",{attrs:{label:"风险"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.searchMap.risk,callback:function(t){e.$set(e.searchMap,"risk",t)},expression:"searchMap.risk"}},[a("el-radio-button",{attrs:{label:"信息"}}),a("el-radio-button",{attrs:{label:"低危"}}),a("el-radio-button",{attrs:{label:"中危"}}),a("el-radio-button",{attrs:{label:"高危"}}),a("el-radio-button",{attrs:{label:"严重"}}),a("el-radio-button",{attrs:{label:"致命"}})],1)],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.searchMap.type,callback:function(t){e.$set(e.searchMap,"type",t)},expression:"searchMap.type"}},[a("el-radio-button",{attrs:{label:"nse"}}),a("el-tooltip",{attrs:{placement:"top"}},[a("div",{attrs:{slot:"content"},slot:"content"},[e._v("前端只能新增Python3"),a("br"),e._v("或HTTP/HTTPS访问的自定义插件")]),a("el-radio-button",{attrs:{label:"selfd"}})],1)],1)],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.fetchData()}}},[e._v("查询")]),a("el-button",{attrs:{type:"info"},on:{click:function(t){return e.resetForm("searchform")}}},[e._v("重置")])],1),a("el-form-item",[a("el-input",{staticStyle:{width:"180px"},attrs:{placeholder:"默认名字：报告",clearable:"","prefix-icon":"el-icon-document"},model:{value:e.filename,callback:function(t){e.filename=t},expression:"filename"}}),a("el-button",{attrs:{loading:e.downloadLoading,type:"success",icon:"el-icon-document"},on:{click:e.handleDownload}},[e._v("导出")])],1),a("el-form-item",[a("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDeleteAll}},[e._v("删除")])],1),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleEdit("")}}},[e._v("新增")])],1)],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.listLoading,expression:"listLoading"}],ref:"multipleTable",staticStyle:{width:"100%"},attrs:{data:e.list,border:"",fit:"","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"},on:{"selection-change":e.handleSelectionChange}},[a("el-table-column",{attrs:{type:"selection",align:"center"}}),a("el-table-column",{attrs:{label:"序号",type:"index",index:1,align:"center",width:"50"}}),a("el-table-column",{attrs:{sortable:"",prop:"name",label:"名称"}}),a("el-table-column",{attrs:{sortable:"",prop:"args",label:"参数","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{sortable:"",prop:"risk",label:"风险"}}),a("el-table-column",{attrs:{sortable:"",prop:"type",label:"类型"}}),a("el-table-column",{attrs:{sortable:"",prop:"validatetype",label:"辅助验证"}}),a("el-table-column",{attrs:{sortable:"",prop:"timeout",label:"超时"}}),a("el-table-column",{attrs:{sortable:"",prop:"plugincode",label:"插件代码","show-overflow-tooltip":""}}),a("el-table-column",{attrs:{fixed:"right",label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"primary",size:"mini",icon:"el-icon-edit",circle:""},on:{click:function(a){return e.handleEdit(t.row.id)}}}),a("el-button",{attrs:{type:"danger",size:"mini",icon:"el-icon-delete",circle:""},on:{click:function(a){return e.handleDelete(t.row.id)}}})]}}])})],1),a("el-pagination",{attrs:{"current-page":e.currentPage,"page-sizes":[10,20,50,200,500,1e3],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"update:currentPage":function(t){e.currentPage=t},"update:current-page":function(t){e.currentPage=t},"size-change":e.handleSizeChange,"current-change":e.fetchData}}),a("el-dialog",{attrs:{title:"编辑",visible:e.dialogFormVisible,width:"50%",center:"","before-close":e.cleanCache},on:{"update:visible":function(t){e.dialogFormVisible=t}}},[a("el-form",{attrs:{"label-width":"100px"}},[a("el-form-item",{attrs:{label:"名称"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:e.pojo.name,callback:function(t){e.$set(e.pojo,"name",t)},expression:"pojo.name"}})],1),a("el-form-item",{attrs:{label:"参数"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:e.pojo.args,callback:function(t){e.$set(e.pojo,"args",t)},expression:"pojo.args"}})],1),a("el-form-item",{attrs:{label:"风险"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:e.pojo.risk,callback:function(t){e.$set(e.pojo,"risk",t)},expression:"pojo.risk"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-radio-group",{attrs:{size:"mini"},model:{value:e.pojo.type,callback:function(t){e.$set(e.pojo,"type",t)},expression:"pojo.type"}},[a("el-radio-button",{attrs:{label:"nse"}}),a("el-radio-button",{attrs:{label:"selfd"}})],1)],1),a("el-form-item",{attrs:{label:"辅助验证",inline:""}},[a("el-checkbox-group",{attrs:{size:"mini"},model:{value:e.checkedChecktypes,callback:function(t){e.checkedChecktypes=t},expression:"checkedChecktypes"}},e._l(e.checks,(function(e){return a("el-checkbox-button",{key:e,attrs:{label:e}})})),1)],1),a("el-form-item",{attrs:{label:"超时"}},[a("el-input",{staticStyle:{width:"300px"},model:{value:e.pojo.timeout,callback:function(t){e.$set(e.pojo,"timeout",t)},expression:"pojo.timeout"}})],1),a("el-form-item",{attrs:{label:"插件代码"}},[a("div",{staticClass:"in-coder-panel"},[a("textarea",{directives:[{name:"model",rawName:"v-model",value:e.nodearea,expression:"nodearea"}],ref:"textarea",domProps:{value:e.nodearea},on:{input:function(t){t.target.composing||(e.nodearea=t.target.value)}}}),e._v(" "),a("el-select",{staticClass:"code-mode-select",on:{change:e.changeMode},model:{value:e.mode,callback:function(t){e.mode=t},expression:"mode"}},e._l(e.modes,(function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})})),1)],1)])],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.handleSave()}}},[e._v("保存")]),a("el-button",{on:{click:function(t){return e.closeDialogForm()}}},[e._v("关闭")])],1)],1)],1)},n=[];a("4de4"),a("7db0"),a("c975"),a("a15b"),a("d81d"),a("b0c0"),a("d3b7"),a("ac1f"),a("841c"),a("1276"),a("fb6a"),a("dca8");function i(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}var l=a("5ad6"),r=a("56b3"),s=a.n(r);a("a7be"),a("b866"),a("db91"),a("697eb"),a("aedd"),a("164b"),a("4895"),a("cbc8"),a("8d70"),a("9f09"),a("a2c1"),a("9c7b"),a("715d"),a("23de");function c(){var e=i([""]);return c=function(){return e},e}var u=window.CodeMirror||s.a,d=["http","dns"],h={data:function(){return{list:[],total:0,currentPage:1,pageSize:10,searchMap:{},dialogFormVisible:!1,pojo:{},id:"",filename:"",listLoading:!0,multipleSelection:[],downloadLoading:!1,nameList:[],argsList:[],searchLoading:!1,checkedChecktypes:[],checks:d,value:"",nodearea:"",code:"",mode:"Python",coder:null,options:{tabSize:4,theme:"idea",lineNumbers:!0,styleActiveLine:!0,line:!0,extraKeys:{Ctrl:"autocomplete"},foldGutter:!0,gutters:["CodeMirror-linenumbers","CodeMirror-foldgutter"],highlightSelectionMatches:{showToken:/\w/,annotateScrollbar:!0},mode:{name:"python",json:!0}},modes:[{value:"x-python",label:"Python"}]}},created:function(){this.fetchData()},methods:{codeMirrorInitialize:function(e){if(this.$refs.textarea&&(this.coder=u.fromTextArea(this.$refs.textarea,this.options),null!==e&&this.coder.setValue(e),this.language)){var t=this._getLanguage(this.language);t&&(this.mode=t.label)}},_getLanguage:function(e){return this.modes.find((function(t){var a=e.toLowerCase(),o=t.label.toLowerCase(),n=t.value.toLowerCase();return o===a||n===a}))},changeMode:function(e){this.coder.setOption("mode","text/".concat(e));var t=this._getLanguage(e).label.toLowerCase();this.$emit("language-change",t)},cleanCache:function(){this.closeDialogForm()},getArgsList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,l["a"].search(1,10,{args:e}).then((function(a){t.argsList=a.data.rows.filter((function(t){return t.args.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.argsList=[]},getNameList:function(e){var t=this;""!==e&&e?(this.searchLoading=!0,setTimeout((function(){t.searchLoading=!1,l["a"].search(1,10,{name:e}).then((function(a){t.nameList=a.data.rows.filter((function(t){return t.name.toLowerCase().indexOf(e.toLowerCase())>-1}))}))}),200)):this.nameList=[]},closeDialogForm:function(){this.dialogFormVisible=!1,this.dialogFormVisible=!1,this.selectedServiceList=[],this.remoteServiceOptions=[],this.selectedVersionList=[],this.remoteServiceOptions=[],this.selectedVulnkeywordList=[],this.remoteVulnkeywordOptions=[],this.selectedVulnList=[],this.remoteVulnOptions=[],this.checkedChecktypes=[],this.code="",this.coder&&this.$refs.textarea&&this.coder.toTextArea()},handleDeleteAll:function(){var e=this;this.multipleSelection&&this.multipleSelection.length?this.$confirm("此操作将永久删除已选记录信息, 包括 插件配置, 资产服务, 资产版本, 漏洞关键词, 漏洞插件配置关联], 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){for(var t=[],a=0;a<e.multipleSelection.length;a++)t.push(e.multipleSelection[a].id);l["a"].deleteAllByIds(t).then((function(t){e.$message({message:t.message,type:t.flag?"success":"error"}),t.flag&&e.fetchData()}))})).catch((function(){e.$message({type:"info",message:"已取消删除"})})):this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},handleSelectionChange:function(e){this.multipleSelection=e},handleDownload:function(){var e=this;this.multipleSelection&&this.multipleSelection.length?(this.downloadLoading=!0,Promise.all([a.e("chunk-4e233b59"),a.e("chunk-28c47c3d")]).then(a.bind(null,"4bf8")).then((function(t){var a=["名称","参数","风险","类型","辅助验证","超时","插件代码"],o=["name","args","risk","type","validatetype","timeout","plugincode"](c()),n=e.multipleSelection,i=e.formatJson(o,n);t.export_json_to_excel({header:a,data:i,filename:e.filename}),e.$refs.multipleTable.clearSelection(),e.downloadLoading=!1})),this.fetchData()):this.$message({message:"^_^至少选择一条记录哦~",type:"info"})},formatJson:function(e,t){return t.map((function(t){return e.map((function(e){return t[e]}))}))},resetForm:function(e){this.$refs[e].resetFields(),this.searchMap={},this.nameList=[],this.argsList=[],this.$message({message:"已清空搜索条件",type:"info"})},handleSizeChange:function(e){this.pageSize=e,this.fetchData()},formatBoolean:function(e){return e?"是":""},fetchData:function(){var e=this;this.listLoading=!0,l["a"].search(this.currentPage,this.pageSize,this.searchMap).then((function(t){e.list=t.data.rows,e.total=t.data.total,e.listLoading=!1}))},handleSave:function(){var e=this;this.checkedChecktypes&&0!==this.checkedChecktypes.length?this.pojo.validatetype=this.checkedChecktypes.join(","):this.pojo.validatetype=null,""===this.pojo.plugincode?this.pojo.plugincode=null:null!==this.coder&&(this.pojo.plugincode=this.coder.getValue()),l["a"].update(this.id,this.pojo).then((function(t){e.$message({message:t.message,type:t.flag?"success":"error"}),t.flag&&e.fetchData()})),this.closeDialogForm()},handleEdit:function(e){var t=this;this.id=e,this.dialogFormVisible=!0,""!==e?l["a"].findById(e).then((function(e){e.flag&&(t.pojo=e.data,t.pojo.validatetype&&0!==t.pojo.validatetype.length&&(t.checkedChecktypes=t.pojo.validatetype.split(",")),t.codeMirrorInitialize(e.data.plugincode))})):(this.codeMirrorInitialize("hello plugin"),this.pojo={})},handleDelete:function(e){var t=this;this.$confirm("此操作将永久删除已选记录信息, 包括 插件配置, 资产服务, 资产版本, 漏洞关键词, 漏洞插件配置关联], 是否继续?","警告",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then((function(){l["a"].deleteById(e).then((function(e){t.$message({message:e.message,type:e.flag?"success":"error"}),e.flag&&t.fetchData()}))})).catch((function(){t.$message({type:"info",message:"已取消删除"})}))}}},p=h,f=(a("8742"),a("2877")),m=Object(f["a"])(p,o,n,!1,null,null,null);t["default"]=m.exports},"5ad6":function(e,t,a){"use strict";a("99af");var o=a("b775"),n="center",i="pluginconfig";t["a"]={getList:function(){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"get"})},search:function(e,t,a){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/search/").concat(e,"/").concat(t),method:"post",data:a})},save:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i),method:"post",data:e})},findById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"get"})},update:function(e,t){return null===e||""===e?this.save(t):Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"put",data:t})},deleteById:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/").concat(e),method:"delete"})},deleteAllByIds:function(e){return Object(o["a"])({url:"/".concat(n,"/").concat(i,"/deleteids"),method:"post",data:e})}}},8742:function(e,t,a){"use strict";var o=a("2709"),n=a.n(o);n.a},bb2f:function(e,t,a){var o=a("d039");e.exports=!o((function(){return Object.isExtensible(Object.preventExtensions({}))}))},dca8:function(e,t,a){var o=a("23e7"),n=a("bb2f"),i=a("d039"),l=a("861d"),r=a("f183").onFreeze,s=Object.freeze,c=i((function(){s(1)}));o({target:"Object",stat:!0,forced:c,sham:!n},{freeze:function(e){return s&&l(e)?s(r(e)):e}})},f183:function(e,t,a){var o=a("d012"),n=a("861d"),i=a("5135"),l=a("9bf2").f,r=a("90e3"),s=a("bb2f"),c=r("meta"),u=0,d=Object.isExtensible||function(){return!0},h=function(e){l(e,c,{value:{objectID:"O"+ ++u,weakData:{}}})},p=function(e,t){if(!n(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!i(e,c)){if(!d(e))return"F";if(!t)return"E";h(e)}return e[c].objectID},f=function(e,t){if(!i(e,c)){if(!d(e))return!0;if(!t)return!1;h(e)}return e[c].weakData},m=function(e){return s&&g.REQUIRED&&d(e)&&!i(e,c)&&h(e),e},g=e.exports={REQUIRED:!1,fastKey:p,getWeakData:f,onFreeze:m};o[c]=!0},fb6a:function(e,t,a){"use strict";var o=a("23e7"),n=a("861d"),i=a("e8b5"),l=a("23cb"),r=a("50c4"),s=a("fc6a"),c=a("8418"),u=a("b622"),d=a("1dde"),h=a("ae40"),p=d("slice"),f=h("slice",{ACCESSORS:!0,0:0,1:2}),m=u("species"),g=[].slice,b=Math.max;o({target:"Array",proto:!0,forced:!p||!f},{slice:function(e,t){var a,o,u,d=s(this),h=r(d.length),p=l(e,h),f=l(void 0===t?h:t,h);if(i(d)&&(a=d.constructor,"function"!=typeof a||a!==Array&&!i(a.prototype)?n(a)&&(a=a[m],null===a&&(a=void 0)):a=void 0,a===Array||void 0===a))return g.call(d,p,f);for(o=new(void 0===a?Array:a)(b(f-p,0)),u=0;p<f;p++,u++)p in d&&c(o,u,d[p]);return o.length=u,o}})}}]);